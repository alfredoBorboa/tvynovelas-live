<!doctype html>
<html>
<head>
<title>Votación Live Tv y Novelas 2015</title>

<script src="../socket.io/socket.io.js"></script>
<script src="../resources/jquery.min.js"></script>
    
<link rel="stylesheet" type="text/css" href="../style.css">

</head>

<body>

<div id="overlayLogo"><img src="../resources/TVyNovelasWeb.png"/></div>

<div id="overlayConfirmacion">
<div id="confirmaVoto">
Por favor confirma tu voto a<br/><br/>
<span id="nombreCandidatoVotado"></span><br/><br/><br/>
    <a href="javascript:void(0)"><div id="btnConfirma">confirmar</div></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)"><div id="btnCancela">cancelar</div></a>
</div>
</div>
    
<div id="overlayBlockVoto"></div>

<div id="contenedor" >
<h1>Mejor Villana</h1>
<div id="candidatos"> 
<a href="javascript:void(0)" valor="dc1jd" class="candidato" ><div class="cuadroCandidato"><div class="imgCandidato"><img src="../resources/imgs/dc1.jpg" width="220" height="220"></div>Daniela Castro</div></a>  
<a href="javascript:void(0)" valor="dc2jd" class="candidato" ><div class="cuadroCandidato"><div class="imgCandidato"><img src="../resources/imgs/dc2.jpg" width="220" height="220"></div>Claudia Ramírez</div></a>
<a href="javascript:void(0)" valor="dc3jd" class="candidato" ><div class="cuadroCandidato"><div class="imgCandidato"><img src="../resources/imgs/dc3.jpg" width="220" height="220"></div>Mayrin Villanueva</div></a>
<a href="javascript:void(0)" valor="dc4jd" class="candidato" ><div class="cuadroCandidato"><div class="imgCandidato"><img src="../resources/imgs/dc4.jpg" width="220" height="220"></div>Azela Robinson</div></a>
</div><!-- candidatos -->
</div><!-- contenedor -->
<script>

  var socket = io();
    
  var mensaje;    
    
  $( "#candidatos" ).on( 'click', '.candidato', function(){
      var valorImagen = $( this ).attr( 'valor' );
      var idImagen = valorImagen.split( 'j' );
      var mensajeLargo = $( this ).children( ".cuadroCandidato" ).html();
      var nombreCandidato = mensajeLargo.replace( "<div class=\"imgCandidato\"><img src=\"../resources/imgs/" + idImagen[ 0 ] + ".jpg\" width=\"220\" height=\"220\"></div>" , "");
      $( "#nombreCandidatoVotado" ).html( nombreCandidato );
      $( "#overlayConfirmacion" ).fadeToggle( "slow" );
      mensaje = $( this ).attr( "valor");
  });
    
  $( "#btnConfirma" ).on( 'click', function(){
      socket.emit( "votoDesdeJurado", mensaje );
      $("*[valor='" + mensaje + "']").children( ".cuadroCandidato" ).children( ".imgCandidato" ).append( "<div id='palomita' style='position:absolute;margin-top:-190px'><img src='../resources/paloma.png'/></div>" );
      $( "#overlayConfirmacion" ).fadeToggle( "slow" );
      //$( "#candidatos" ).children().click( false );
      $( "#overlayBlockVoto" ).show();
      return false;
  });
    
  $( "#btnCancela" ).on( 'click', function(){
      $( "#overlayConfirmacion" ).fadeToggle( "slow" );
  });
    
  
    
  socket.on( "ordenaSegundaVotacion", function( msg ){
      $( "#candidatos" ).html( "" );
      for( var i = 0; i < ( msg.length / 2 ); i++ ){
          var soloNombre = msg[ i ].split( "<" );
        $( "#candidatos" ).append( "<a href='javascript:void(0)' valor='dc" + msg[ i + ( msg.length / 2 ) ] + "jd' class='candidato' ><div class='cuadroCandidato'><div class='imgCandidato'><img src='../resources/imgs/dc" + msg[ i + ( msg.length / 2 ) ] + ".jpg' width='220' height='220'></div>" + soloNombre[ 0 ] + "</div></a> " );
      }
      //$( "#candidatos" ).children().click( true );
      $( "#overlayBlockVoto" ).hide();
      realinea();
    });
    
  socket.on( "activaOverlayLogoVotante", function( msg ){
    if( msg == 1 ){
        $( "#overlayLogo" ).fadeIn( "slow" );
    }
  });
    
    socket.on( "desactivaOverlayLogoVotante", function( msg ){
    if( msg == 1 ){
        $( "#overlayLogo" ).fadeOut( "slow" );
    }
  });
    
  socket.on( "siguienteSeccionVotante", function( msg ){
    if( msg == 1 ){
        window.location.href = "categoria_e.html";
    }
  });
    
    socket.on( "recibeRefresh", function( msg ){
    if( msg == 1 ){
        location.reload();
    }
  });
    
    function realinea(){
  var numChildCandidatos = $( "#candidatos" ).children().length;
      
  if( numChildCandidatos == 6 ){
      $( "#candidatos a:nth-child( 5 )" ).children( ".cuadroCandidato" ).css( "margin-left", "220px" );
  }
      
  if( numChildCandidatos == 5 ){
      $( "#candidatos a:nth-child( 5 )" ).children( ".cuadroCandidato" ).css( "margin-left", "320px" );
  }
      
  if( numChildCandidatos == 3 ){
      $( "#candidatos a:nth-child( 1 )" ).children( ".cuadroCandidato" ).css( "margin-left", "120px" );
  }
      
  if( numChildCandidatos == 2 ){
      $( "#candidatos a:nth-child( 1 )" ).children( ".cuadroCandidato" ).css( "margin-left", "220px" );
  }
      
  }
  realinea();
  
</script>

</body>
</html>
